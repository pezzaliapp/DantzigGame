<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <title>Dantzig Game — LP Puzzle</title>
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#111318">
  <link rel="icon" href="icon-192.png">
  <link rel="apple-touch-icon" href="icon-512.png">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header>
    <h1>Dantzig Game <span class="badge">LP</span></h1>
    <button id="newBtn" class="primary">Nuovo</button>
    <button id="checkBtn">Verifica</button>
    <button id="hintBtn">Hint</button>
    <label class="toggle">Snap interi <input type="checkbox" id="snapInt"></label>
    <label class="toggle">Boolean {0,1} <input type="checkbox" id="boolMode"></label>
    <label class="toggle">Adatta in altezza <input type="checkbox" id="fitHeight"></label>
    <label>Modalità
      <select id="modeSel">
        <option value="classic">Classica</option>
        <option value="time">Tempo ⏱️</option>
        <option value="hidden">Vincoli nascosti 🔒</option>
      </select>
    </label>
    <span id="timer" class="muted" style="min-width:70px;display:none;">60s</span>
    <button id="probeBtn" style="display:none;">Sonda</button>
    <label>Livello
      <select id="levelSel">
        <option value="easy">Facile</option>
        <option value="medium">Medio</option>
        <option value="hard">Difficile</option>
      </select>
    </label>
    <button id="simplexBtn">Simplex step</button>
    <button id="helpBtn" aria-label="Aiuto">?</button>
    <span class="spacer"></span>
    <span id="bestScore">Best: —</span>
    <span id="status">—</span>
  </header>

  <main>
    <section id="left">
      <div id="plotWrap"><canvas id="plot" aria-label="Grafico vincoli"></canvas></div>
      <div id="legend">
        <div><span class="chip feasible"></span>Regione ammissibile</div>
        <div><span class="chip constraint"></span>Vincoli</div>
        <div><span class="chip objective"></span>Linea obiettivo</div>
        <div><span class="chip player"></span>Tuo punto</div>
        <div><span class="chip optimum"></span>Ottimo</div>
      </div>
    </section>

    <section id="right">
      <div class="card">
        <h2>Problema</h2>
        <p id="problemText"></p>
        <details>
          <summary>Vincoli</summary>
          <pre id="constraintsText"></pre>
        </details>
      </div>

      <div class="card">
        <h2>Tentativo</h2>
        <div class="controls">
          <label>x: <input type="number" step="0.1" id="xVal"></label>
          <label>y: <input type="number" step="0.1" id="yVal"></label>
          <button id="centerBtn">Centra</button>
        </div>
        <p>Trascina il punto sul grafico oppure inserisci x e y.</p>
      </div>

      <div class="card">
        <h2>Punteggio</h2>
        <p id="scoreBox">—</p>
        <p class="muted">Bonus: +10 se in modalità intera/booleana e il punto è ammissibile.</p>
      </div>

      <div class="card">
        <h2>Simplex (pivot su vertici)</h2>
        <div class="controls">
          <button id="sxPrev">⟵</button>
          <button id="sxNext">⟶</button>
          <span id="sxStep">—</span>
        </div>
        <p class="muted">Percorso didattico tra i vertici con z crescente.</p>
      </div>

      <div class="card">
        <h2>Note</h2>
        <p>I problemi sono generati in modo che l'ottimo cada in un vertice della regione ammissibile. La retta dell'obiettivo è una curva di livello di z = c₁x + c₂y.</p>
      </div>
    </section>
  </main>

  <footer>
    <small>© 2025 PezzaliAPP — Dantzig Game (MIT). PWA offline. <a href="#" id="installLink">Installa</a></small>
  </footer>

  <dialog id="tutorial">
    <h2>Come si gioca a Dantzig Game</h2>
    <h3>🎯 Scopo</h3>
    <p>C’è un tesoro chiamato <strong>z = c₁·x + c₂·y</strong>. Più vai nella direzione giusta, più z cresce.
    Ma ci sono dei <strong>muri invisibili</strong> (vincoli) che ti fanno muovere solo nella <strong>zona blu</strong>.</p>
    <h3>🕹️ Come si gioca</h3>
    <ol>
      <li>Premi <strong>Nuovo</strong> per creare una mappa.</li>
      <li>Guarda la <strong>zona blu</strong>: è dove puoi muoverti.</li>
      <li>Trascina il <strong>puntino giallo</strong> dentro la zona blu.</li>
      <li>Premi <strong>Verifica</strong> per sapere quanto vali.</li>
    </ol>
    <h3>🏆 Punteggio</h3>
    <ul>
      <li><strong>0–100</strong> punti in base a quanto il tuo z è vicino a z*.</li>
      <li><strong>100</strong> = punto ottimo.</li>
      <li><strong>+10</strong> extra con Snap interi o Boolean {0,1} se ammissibile.</li>
    </ul>
    <h3>📚 Aiuti</h3>
    <ul>
      <li><strong>Hint</strong> → retta z = costante + freccia “più z →”.</li>
      <li><strong>Simplex step</strong> → percorso di vertici con z crescente.</li>
    </ul>
    <div class="controls">
      <label><input type="checkbox" id="dontShow"> Non mostrare più</label>
      <button id="closeTutorial" class="primary">OK</button>
    </div>
  </dialog>

  <script src="app.js"></script>
</body>
</html>
